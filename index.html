<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=0.9" />
<title>IP连通性检测 (IPv4 / IPv6)</title>
<style>
	:root { color-scheme: dark; }
	* { box-sizing: border-box; }
	html, body { height: 100%; }
	body {
		margin: 0;
		font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC", "Microsoft Yahei", sans-serif;
		background: #0b0f14;
		color: #e6edf3;
	}
	.header {
		position: sticky; top: 0; z-index: 10;
		background: rgba(11,15,20,0.85);
		backdrop-filter: blur(8px);
		border-bottom: 1px solid #1f2937;
	}
	.header-inner {
		max-width: 980px; margin: 0 auto; padding: 14px 20px; display:flex; align-items:center; justify-content:space-between;
	}
	.brand { font-weight: 700; letter-spacing: .3px; }
	.container { max-width: 960px; margin: 0 auto; padding: 24px 20px; }
	.stack { display:flex; flex-direction: column; gap: 18px; align-items: center; }
	.card { width: 100%; max-width: 860px; }
	.grid { display: block; }
	@media (max-width: 900px){ .grid{ display: block; } }
	.card { background:#111827; border:1px solid #1f2937; border-radius: 14px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.35); }
	h1 { margin: 0 0 10px; font-size: 22px; }
	p.desc { margin: 0 0 16px; color:#9ca3af; }
	.form { display:flex; gap:10px; margin-bottom: 14px; }
	.input { flex:1; padding:12px 14px; background:#0b1220; border:1px solid #1f2937; border-radius:10px; color:#e6edf3; outline:none; }
	.input:focus { border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,0.2); }
	.button { padding: 12px 16px; background: linear-gradient(135deg, #2563eb, #7c3aed); border:none; border-radius:10px; color:white; cursor:pointer; font-weight:600; }
	.button:disabled { opacity:.6; cursor:not-allowed; }
	.result { background:#0b1220; border:1px solid #1f2937; border-radius:10px; padding:12px 14px; white-space:pre-wrap; word-break:break-all; min-height:48px; }
	.badge { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; }
	.ok { background:#064e3b; color:#34d399; }
	.no { background:#3f1d1d; color:#fca5a5; }
	.section-title { font-weight:700; margin: 0 0 10px; font-size: 16px; }
	.code { background:#0b1220; border:1px solid #1f2937; border-radius:8px; padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; color:#e6edf3; }
	.footer { color:#6b7280; font-size:12px; padding: 20px; text-align:center; border-top: 1px solid #1f2937; margin-top: 36px; }
	.medal-cn { background: linear-gradient(135deg,#059669,#10b981); color:#eafff5; border:1px solid #065f46; border-radius:999px; padding:2px 8px; font-size:12px; margin-left:8px; vertical-align:middle; }
	.medal-huise { background: linear-gradient(135deg,#6f74c2,#10b981); color:#eafff5; border:1px solid #065f46; border-radius:999px; padding:2px 8px; font-size:12px; margin-left:8px; vertical-align:middle; }
	.details { background:#0b1220; border:1px solid #1f2937; border-radius:10px; padding:10px 12px; }
	.details summary { cursor:pointer; color:#9ca3af; }
	.api-block .section-title { margin-top: 10px; }
</style>
</head>
<body>
	<header class="header">
		<div class="header-inner">
			<div class="brand">IP连通性检测 <span class="medal-cn">国内</span></div>
			<nav style="opacity:.8; font-size: 13px;">IPv4 / IPv6 / 域名</nav>
		</div>
	</header>
	<main class="container">
		<div class="stack">
			<section class="card">
				<h1>IP连通性检测<span class="medal-cn">国内服务器</span><span class="medal-huise">腾讯云支持ipv4/ipv6</span></h1>
				<p class="desc">输入 IPv4 / IPv6 / 域名（域名可选IPv4/IPv6），点击检测。只要能 ping 通即视为 ok。</p>
				<div class="form">
					<input id="ip" class="input" placeholder="例如: 1.1.1.1 或 2606:4700:4700::1111 或 example.com" />
					<button id="btn" class="button">检测</button>
				</div>
				<div id="status"></div>
				<pre id="result" class="result"></pre>
			</section>
			<aside class="card api-block">
			<details class="details">
				<summary>API 请求方式（点击展开/收起）</summary>
				<div class="section-title">非 JSON</div>
				<div class="code">GET /api/ping?ip=xxx
<br/>
返回: text/plain
<br/>
示例: ipv4:ok,ipv6:ok</div>
				<div class="section-title">JSON</div>
				<div class="code">GET /api/ping/json?ip=xxx
<br/>

返回: application/json
<br/>

示例: {"code":200,"msg":"success","data":{"ipv4":"ok","ipv6":"ok"}}</div>
			</details>
			<div class="section-title">说明</div>
			<ul style="margin:0 0 0 16px; padding:0; color:#9ca3af;">
				<li>支持 IPv4、IPv6 与域名（自动按族解析并分别检测）</li>
				<li>大并发友好：后端对解析与 ping 并行处理，短超时</li>
				<li>在中国大陆服务器上部署时，请确保系统已启用 IPv6</li>
			</ul>
					</aside>
		</div>
	</main>
	<footer class="footer">
		<span>© 2025 golxc.com 备案号：孬ICP备11451919180号-1</span>
	</footer>
<script>
const $ = (s) => document.querySelector(s);
const ipInput = $('#ip');
const btn = $('#btn');
const statusDiv = $('#status');
const resultPre = $('#result');

function badge(label, ok) {
	const cls = ok ? 'badge ok' : 'badge no';
	return '<span class="' + cls + '">' + label + ': ' + (ok ? 'ok' : 'no') + '</span>';
}

async function run() {
	const ip = ipInput.value.trim();
	if (!ip) { ipInput.focus(); return; }
	btn.disabled = true; resultPre.textContent = '检测中...'; statusDiv.innerHTML = '';
	try {
		const res = await fetch('/api/ping/json?ip=' + encodeURIComponent(ip));
		const data = await res.json();
		if (data && data.code === 200 && data.data) {
			const v4ok = String(data.data.ipv4).toLowerCase() === 'ok';
			const v6ok = String(data.data.ipv6).toLowerCase() === 'ok';
			statusDiv.innerHTML = badge('IPv4', v4ok) + ' \u00A0 ' + badge('IPv6', v6ok);
			resultPre.textContent = 'ipv4:' + data.data.ipv4 + ',ipv6:' + data.data.ipv6;
		} else {
			statusDiv.innerHTML = badge('结果', false);
			resultPre.textContent = JSON.stringify(data, null, 2);
		}
	} catch (e) {
		statusDiv.innerHTML = badge('异常', false);
		resultPre.textContent = String(e);
	} finally {
		btn.disabled = false;
	}
}

btn.addEventListener('click', run);
ipInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') run(); });
</script>
</body>
</html> 